
#### Ответ для собеседования

`Depends` – это механизм инъекции зависимостей внутри эндпоинтов в FastAPI. Конечный потребитель `Depends` – это всегда эндпоинт. `Depends` позволяет запускать цепочку функций, от которых зависит данный эндпоинт, например, аутентификация, получение сессии базы данных.

#### Подробный ответ

`Depends` в FastAPI — это специальный механизм для внедрения зависимостей (dependency injection). Он позволяет нам декларировать и управлять зависимостями, которые нужны для обработки запросов. Это полезно для реализации общих функций, таких как проверка аутентификации, подключение к базе данных или выполнение другой повторяющейся логики.

При создании эндпоинтов/ручек можно использовать `Depends` для внедрения зависимостей. Например, если у нас есть функция, которая проверяет аутентификацию пользователя, мы можем использовать ее в маршрутах с помощью `Depends`:

```python

from fastapi import FastAPI, Depends, HTTPException

app = FastAPI()

def verify_token(token: str):
    if token != "valid-token":
        raise HTTPException(status_code=401, detail="Невалидный токен")

@app.get("/users")
def read_users(token: str = Depends(verify_token)):
    return {"users": ["user1", "user2"]}
    
```

В этом примере функция `verify_token` используется в эндпоинте `/users`. Если токен невалидный, вызывается исключение `HTTPException`, и клиент получает ошибку.

#### Классы как зависимости

Можно использовать классы как зависимости для управления состоянием или разделения логики:

```python

from fastapi import Depends, FastAPI

app = FastAPI()

class CommonQueryParams:
    def __init__(self, q: Optional[str] = None, skip: int = 0, limit: int = 10):
        self.q = q
        self.skip = skip
        self.limit = limit

@app.get("/users")
def read_users(params: CommonQueryParams = Depends()):
    response = {"params": params}
    return response
    
```

Здесь класс `CommonQueryParams` инкапсулирует общие параметры запроса. Это позволяет нам избегать повторения кода и улучшает читаемость маршрутов. Например, если вы используете пагинацию, фильтрацию и сортировку на множестве эндпоинтов, вам достаточно использовать зависимость `CommonQueryParams`, чем прописывать все параметры каждый раз, нарушая принцип DRY.