
## Что такое модель MVC

MVC расшифровывается как «модель-представление-контроллер» (от англ. model-view-controller). Это способ организации кода, который предполагает выделение блоков, отвечающих за решение разных задач. Один блок отвечает за данные приложения, другой отвечает за внешний вид, а третий контролирует работу приложения. Используется для создания динамичных веб-страниц. которые реагируют на действия пользователя.

Компоненты MVC:

- Модель (model) — этот компонент отвечает за данные, а также определяет структуру приложения. Например, если вы создаете To-Do приложение, код компонента `model` будет определять список задач и отдельные задачи.
- Представление (view) — этот компонент отвечает за взаимодействие с пользователем. То есть код компонента `view` определяет внешний вид приложения и способы его использования.
- Контроллер (controller) — этот компонент отвечает за связь между `model` и `view`. Код компонента `controller` определяет, как сайт реагирует на действия пользователя. По сути, это мозг MVC-приложения.

## Разбираем MVC на примере магазина

Представьте, что вы пришли в магазин или кафе, где можно заказать сэндвич. В меню есть бутерброды с тунцом, индейкой и ветчиной. Вы заказываете сэндвич с индейкой. Продавец понимает вас с полуслова. Он поворачивается в сторону кухни и говорит поварам, чтобы они приготовили сэндвич с индейкой.

У поваров под рукой есть разные продукты: тунец, индейка, ветчина, сыр, листья салата и другие ингредиенты, которые добавляют в бутерброды. Они выбирают только то, что нужно для вашего сэндвича с индейкой. Вы получаете свой заказ.

Покупку бутерброда можно описать через MVC:

- Модель: кухня, на которой повар делает сэндвич
- Представление: готовый бутерброд, который вы с удовольствием едите
- Контроллер: продавец или бармен, который принимает заказ и передаёт его на кухню.

![[Pasted image 20240609211940.png]]

Вы уже представляли готовый сэндвич с индейкой, когда заказывали его бармену. Это представление или `view`.

Точно так же можно представить взаимодействие с сайтом. Когда вы заходите на сайт и переходите по ссылке «Заказать сендвич», то заранее представляете результат перехода по ссылке. Это страница оформления заказа или корзина.

Когда вы нажимаете на ссылку «Оформить заказ», на наш сервер уходит запрос. В нём содержится просьба на вывод на экран информациии о том, что заказ успешно обработан и едет к вам. Это очень похоже на просьбу продать вам бутерброд с индейкой. Это контроллер.

На сервере ваш запрос обрабатывается. Программа заносит в базы данных ваши данные по заказу, затем будет выводить их на экран кухни, где их будут готовить. Это можно сравнить с кухней и поварами из примера с сэндвичем. Это модель.

Сервер отправляет страницу с сообщением о успешной обработке заказа и информацией сколько это может примерно занять  зависимости от нагрузки на кухню, для чего опять же производится анализ в БД. Тем же занимались повара на кухне магазина сэндвичей. Это снова представление или `view`.

## Django использует модель MTV (Model – Template - View).

- Первый слой (Models) - модели, это тот слой, который хранит информацию о том как можно получить ту или иную информацию.

- Второй слой (View) – это слой представления данных. Этот слой хранит в себе все представления данных в проекте, как и что должно отображаться на web странице.

- Последний, третий слой (Templates) – это слой, который в себе содержит логику. И именно этот слой отвечает за выбор шаблонов для определенный действий.

### Почему же принцип MTV так важен для веб-приложений на Django?

_Ответ на этот вопрос - раздeлeниe и нeзависимоe использование уровней._

Фрeймворк Djаngo нaписaн на языкe прогрaммирования Pythоn, пoэтoму его структура соответствует особенностям языка. Создатели реализовали в фреймворке паттерн MTV, придерживаясь схожести с MVC. Этот паттерн применяется и в текущей версии Django.

### Как это работает в подробностях

Читая описание MTV дальше, можно подумать, что шаблоны – это представления, а представления – это контроллеры. Не совсем так. Контроллер – это встроенный в django URL-маршрутизатор, который обеспечивает логику запрос-ответ. Представления нужны для представления нужных данных в нужных шаблонах. Шаблоны и представления совокупно составляют «презентационный» слой фреймворка (то что увидит пользователь - красивые кнопочки).  
  
Давайте подробнее разберемся как в Django работает механизм обработки запросов от пользователя. Нам это понимание пригодится в дальнейшем, описывая отдельные элементы всей этой процедуры.

Смотрите, вначале, когда запрос приходит на фреймворк, он пропускается через блок маршрутизации:

![](https://proproprogs.ru/htm/django/files/model-mtv-marshrutizaciya-funkcii-predstavleniya.files/image001.jpg)

Здесь фиксируется тип URL-адреса и в списке шаблонов предопределенных адресов ищется первое совпадение. Например, пользователь вводит запрос:

http://127.0.0.1:8000/

Это есть не что иное, как главная страница сайта, фактически пустой запрос без параметров. Следующий запрос:

http://127.0.0.1:8000/category/1/

соответствует шаблону:

category/<число>

Это уже другой маршрут. Или такой запрос:

http://127.0.0.1:8000/women/madonna/

с шаблоном:

women/<слаг (строка)>

И так далее. У нас может быть прописано множество типов URL-адресов и каждый адрес связан со своим обработчиком – представлением (иногда его еще называют контроллером). Если текущий запрос от пользователя не совпал ни с одним предопределенным URL, то возвращается код ошибки 404 – страница не найдена.

Предположим, что маршрутизатор нашел совпадение. Далее, активизируется представление, связанное с найденным типом URL-адреса. Представление (иногда его еще называют контроллером) – это или функция или класс, который отвечает за формирование ответа на соответствующий запрос. Как правило, ответом является HTML-страница. Эта страница, затем, возвращается клиенту, и он ее видит в браузере. Так вот, чтобы контроллер мог сформировать страницу, в общем случае, требуются данные (информация), плюс  шаблоны, в которые эти данные упаковываются. Например, приходит запрос на вывод страницы о Мадонне:

http://127.0.0.1:8000/women/madonna/

Активизируется соответствующее представление, которое берет шаблон информационной страницы и наполняет ее данными об этой певице, хранящиеся в БД:

![](https://proproprogs.ru/htm/django/files/model-mtv-marshrutizaciya-funkcii-predstavleniya.files/image002.jpg)

На выходе получаем сформированную HTML-страницу, которая и возвращается пользователю. Вот такое разделение на данные (model), шаблоны (templates) и представления (views) представляет собой общеизвестный паттерн MTV, то есть, разделение данных и HTML-шаблонов. Техника довольно эффективна и удобна, так как позволяет независимо наполнять БД информацией и параллельно разрабатывать или изменять функционал сайта. Кроме того здесь легче находить ошибки, в отличие от подхода, когда в одном скрипте присутствует и подключение к БД и оперирование шаблонами. Методика «разделяй и властвуй» очень хорошо себя зарекомендовала в мире программирования и довольно часто используется в том или ином виде.