
# Команда git fetch — чем отличается от git pull

Для чего нужна команда git fetch, как работает и чем отличается git pull от git fetch.


## Введение

В этой инструкции мы расскажем, для чего нужна команда git fetch, как работает и чем отличается git pull от git fetch. 

## Git fetch, что делает данная команда

Git fetch — команда в распределенной системе контроля версий Git, которая используется для скачивания изменений из удаленного или локального репозитория в свой локальный репозиторий.

```shell

git fetch [<опции>] [<репозиторий> | <группа репозиториев>]

```

Польза git fetch в том, что эта команда привносит актуальность локальному репозиторию без изменения его дерева или текущей ветки. Таким образом, следить за изменениями, сделанными другими участниками, становится проще, быстрее можно начать работу с этими изменениями.

## Что произойдет при выполнении команды git fetch

Данная команда извлекает все новые объекты из удаленного репозитория и хранит их в локальном репозитории, обновляя ветки, теги и другие метаданные локального репозитория. Таким образом, отражается состояние удаленного репозитория. 

Перед дальнейшими шагами после выполнения команды хорошей практикой считается просмотреть изменения, чтобы убедиться, что они не приведут к дальнейшим конфликтам. Вот некоторые команды, которые можно использовать после команды git fetch:

Перейти к списку удаленных веток, которые были обновлены во время операции git fetch:

```shell

git branch -r

```

Сравнить свою локальную ветку с обновленной удаленной веткой и увидеть различия:

```shell

git diff

```

Просмотреть историю коммитов обновленной удаленной ветки и понять, какими были внесенные изменения:

```shell

git log

```

Переключиться на обновленную удаленную ветку и начать работать с внедренными изменениями:

```shell

git checkout

```

Включить изменения из удаленного репозитория в локальную копию проекта путем слияния. Считается самым частым действием после операции git fetch:

```shell

git merge

```

Наложить локальные коммиты поверх обновленной удаленной ветки. Такой вариант должен использоваться с осторожностью, так как в результате может привести к конфликтам, если удаленная ветка сильно изменилась:

```shell

git rebase 

```

Важно помнить, что git fetch только обновляет удаленные ссылки и ветки, но не производит слияния с локальной веткой. Для внедрения изменений используется одна из двух последних приведенных в пример команд. 

## Разница между git pull и git fetch

Cуществуют четыре команды, которые скачивают код из удаленного репозитория: **git clone, git remote update, git fetch, git pull**. Последние 3 команды очень похожи друг на друга.

**Git clone**, или же клонирование репозитория, полностью копирует запрашиваемый репозиторий, происходит его фиксация и установка ветки по умолчанию.

Между **git remote update** и **git fetch** отличие лишь в том, что первая из этих команд обновляет все удаленные подключения, а **git fetch** — только один репозиторий или группу репозиториев. Но есть опция, нивелирующая разницу между этими командами. Мы рассмотрим ее ниже в параграфе про опции.

**Git pull** — связка последующих команд **git fetch** и **git merge**. 

```shell

git pull [<опции>] [<репозиторий>]

```

Такой способ ускоряет внедрение новых изменений в локальный репозиторий, но и является менее управляемым. **Git pull** следует применять, если у вас нет цели посмотреть изменения перед слиянием или вы не хотите медлить перед интеграцией изменений в локальную ветку.

К **git pull** применяются опции как от **git fetch**, так и от **git merge.** Если же вы хотите произвести rebase вместо merge, то используйте соответствующую опцию:

```shell

git pull --rebase [<репозиторий>]

```

## Полезные опции и настройки для команды git fetch

### Настройки

Все настройки выполняются в **.git/config**, либо командой **git config —edit**.

Чтобы использовать git fetch, разработчик должен настроить подключение к удаленному репозиторию. Это можно сделать командой **git remote**, которая позволяет добавлять, удалять и управлять удаленными репозиториями. Когда удаленный репозиторий будет готов, команда **git fetch** может быть использована для получения последних изменений из удаленного репозитория.

Если необходимо обновить только одну ветку, например, master, не задействуя остальные доступные ветки в удаленном репозитории, то можно внести следующую настройку в конфигурации удаленного подключения к этому репозиторию: 

```shell

[remote “origin]
fetch = +refs/heads/master:refs/remotes/origin/master

```

Или просто введя в консоль:

```shell

git fetch origin master

```

После набора **git fetch** с названием репозитория данная настройка будет вызываться по умолчанию. Если же такая настройка необходима однократно, то при наборе команды можно сразу указать соответствие веток. Итак, для получения данных, например, из ветки super-branch удаленного репозитория в локальную origin/super-branch, прописывается такая команда:

```shell

git fetch origin master:refs/remotes/origin/super-branch

```

Команда выполнится для ветки super-branch локального репозитория, получив данные из удаленного репозитория. 

Если нужен не один репозиторий, а несколько, то группа репозиториев настраивается через **remotes.group** следующим образом:

```shell

[remotes] 
group1 = first-remote second-remote commit 
group2 = only-one-remote

```

Есть возможность включить автоматическую подписку на теги во время git fetch. То есть Git будет скачивать все новые теги из удаленного репозитория и создавать локальные теги, которые будут указывать на те же коммиты, как и в удаленном репозитории. Можно включить эту опцию глобально, добавив **—global** к команде **git config —edit**:

```shell

tags = true

```

### Опции

Есть ряд опций, доступных с командой git fetch, которые позволяют разработчикам указать точные изменения. Например, можно использовать опцию **—prune**, чтобы удалить отслеживаемые ветки, которые больше не существуют в удаленном репозитории. Это помогает содержать локальный репозиторий в чистоте и уменьшает беспорядок в списке веток.

```shell

git fetch --prune 

```

Другая опция **—all**, которая позволяет разработчикам получить изменения со всех настроенных удаленных репозиториев в локальный репозиторий. Она может быть полезна в ситуациях, когда в проекте есть несколько репозиториев и разработчикам нужно подхватывать изменения из них всех. Получается аналог команды **git remote update**. 

```shell

git fetch --all

```

Следующая опция продемонстрирует работу **git fetch** без дальнейшего обновления каких-либо локальных веток. Это может быть полезно для теста и просмотра изменений, которые будут получены в результате выполнения **git fetch**:

```shell

git fetch --dry-run

```

## Пример: git fetch origin

Пусть у нас будет настроен удаленный репозиторий на GitHub (на GitLab будет тоже самое), который мы назвали локально «origin». На нем существуют ветки master и feature-branch.

Для начала перейдем к локальному репозиторию, который планируем обновить:

```shell

cd ~/my-best-project

```

Затем используем git fetch, чтобы получить последние изменения из удаленного репозитория:

```shell

git fetch origin

```

После того как операция git fetch завершится, можно проверить обновленные удаленные ветки:

```shell

git branch -r

> origin/master
> origin/feature-branch
> 
```

Теперь сравним локальную ветку с обновленной удаленной веткой, чтобы увидеть различия:

```shell

git diff origin/master

```

Также можно посмотреть историю коммитов обновленной удаленной ветки:

```shell

git log origin/master

```

Переключимся на обновленную удаленную ветку:

```shell

git checkout origin/master

```

Cольем изменения из обновленной удаленной ветки в нашу локальную ветку:

```shell

git merge origin/master

```

Выбор дальнейших команд после выполнения команды **git fetch** зависят от специфики использования данной команды и структуры репозитория. 

## Заключение

- Ветки с удаленным отслеживанием: git fetch работает с ветками с удаленным отслеживанием, которые являются ссылками на состояние удаленных веток в локальном репозитории. 
- Сетевое взаимодействие: git fetch взаимодействует с удаленным репозиторием по протоколу Git и получает информацию об удаленных ветках и их последнем состоянии. Эта информация хранится в локальном репозитории в виде веток удаленного отслеживания.
- Получение изменений: команда git fetch извлекает информацию о последних изменениях, внесенных в удаленный репозиторий, и соответствующим образом обновляет ветки удаленного отслеживания. Сюда входят последние хэши коммитов, имена веток и сообщения коммитов.
- Слияние изменений: после того, как git fetch извлечет изменения из удаленного репозитория, можно использовать команду git merge или git rebase, чтобы объединить изменения с локальной веткой.
- Опции git fetch: можно использовать различные опции команды git fetch для управления ее поведением. Например, указать другой удаленный репозиторий, ограничить количество веток или даже удалить ветки, которые были удалены из удаленного репозитория.